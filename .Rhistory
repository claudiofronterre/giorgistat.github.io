annotate("text", x = -2.5, y = 0.1*max(impact_data$Impact, na.rm = TRUE),
label = "Baseline", color = "black", hjust = 0.5) +
annotate("text", x = -5, y = 0.6*max(impact_data$Impact, na.rm = TRUE),
label = "MDA Implementation", color = "blue", hjust = 0) +
annotate("text", x = text_x_pos[1], y = text_y_pos[1],
label = "Actual Impact", color = "black", hjust = 0) +
annotate("text", x = text_x_pos[2], y = text_y_pos[2],
label = "Exponential Approximation", color = "green", hjust = 0) +
geom_vline(xintercept = mode_time, linetype = "dotted", color = "gray50") +
annotate("text", x = mode_time, y = 0,
label = "Impact Survey", vjust = -0.5, color = "gray30") +
labs(title = "Impact of Mass Drug Administration (MDA) Over Time",
x = "Time (years)",
y = "Relative Prevalence Reduction",
caption = "Blue dashed line: MDA implementation time\nGreen dashed line: Exponential decay approximation from impact survey") +
theme_minimal() +
theme(plot.caption = element_text(hjust = 0)) +
ylim(0, max(impact_data$Impact, na.rm = TRUE) * 1.1) +
# Ensure no text overlap
coord_cartesian(clip = "off") +
theme(plot.margin = unit(c(1, 1, 1.5, 1), "lines"))
#| echo: false
#| fig-cap: "Impact of MDA over time with Gamma-distributed effect and exponential decay approximation"
#| fig-width: 8
#| fig-height: 5
library(ggplot2)
# Create time sequence (-5 to 20 years)
time <- seq(-5, 20, by = 0.1)
# Define Gamma-shaped MDA impact function
gamma_impact <- function(t) {
# Parameters for Gamma distribution (shape=3, rate=0.7 gives mode around 3)
dgamma(pmax(0, t), shape = 3, rate = 0.7) * 15 # Scaled for visibility
}
# Find the mode (peak time) of the Gamma distribution
mode_time <- (3 - 1)/0.7  # (shape-1)/rate
peak_impact <- gamma_impact(mode_time)
# Exponential decay starting at mode
exp_decay <- function(t) {
peak_impact * exp(-0.25 * (t - mode_time))
}
# Create data frame
impact_data <- data.frame(
Time = time,
Impact = ifelse(time < 0, 0, gamma_impact(time)),
Exponential_Fit = ifelse(time >= mode_time, exp_decay(time), NA)
)
# Calculate optimal text positions
text_y_pos <- max(impact_data$Impact, na.rm = TRUE) * c(0.9, 0.7, 0.5)
text_x_pos <- c(mode_time + 3, mode_time + 3, 5)
# Plot
ggplot(impact_data, aes(x = Time)) +
geom_vline(xintercept = 0, linetype = "dashed", color = "blue") +
geom_line(aes(y = Impact), color = "black", linewidth = 1.2) +
geom_line(aes(y = Exponential_Fit), color = "green", linetype = "dashed", linewidth = 1, na.rm = TRUE) +
# Annotations with non-overlapping positions
annotate("text", x = -2.5, y = 0.1*max(impact_data$Impact, na.rm = TRUE),
label = "Baseline", color = "black", hjust = 0.5) +
annotate("text", x = -6, y = 0.6*max(impact_data$Impact, na.rm = TRUE),
label = "MDA Implementation", color = "blue", hjust = 0) +
annotate("text", x = text_x_pos[1], y = text_y_pos[1],
label = "Actual Impact", color = "black", hjust = 0) +
annotate("text", x = text_x_pos[2], y = text_y_pos[2],
label = "Exponential Approximation", color = "green", hjust = 0) +
geom_vline(xintercept = mode_time, linetype = "dotted", color = "gray50") +
annotate("text", x = mode_time, y = 0,
label = "Impact Survey", vjust = -0.5, color = "gray30") +
labs(title = "Impact of Mass Drug Administration (MDA) Over Time",
x = "Time (years)",
y = "Relative Prevalence Reduction",
caption = "Blue dashed line: MDA implementation time\nGreen dashed line: Exponential decay approximation from impact survey") +
theme_minimal() +
theme(plot.caption = element_text(hjust = 0)) +
ylim(0, max(impact_data$Impact, na.rm = TRUE) * 1.1) +
# Ensure no text overlap
coord_cartesian(clip = "off") +
theme(plot.margin = unit(c(1, 1, 1.5, 1), "lines"))
#| echo: false
#| fig-cap: "Impact of MDA over time with Gamma-distributed effect and exponential decay approximation"
#| fig-width: 8
#| fig-height: 5
library(ggplot2)
# Create time sequence (-5 to 20 years)
time <- seq(-5, 20, by = 0.1)
# Define Gamma-shaped MDA impact function
gamma_impact <- function(t) {
# Parameters for Gamma distribution (shape=3, rate=0.7 gives mode around 3)
dgamma(pmax(0, t), shape = 3, rate = 0.7) * 15 # Scaled for visibility
}
# Find the mode (peak time) of the Gamma distribution
mode_time <- (3 - 1)/0.7  # (shape-1)/rate
peak_impact <- gamma_impact(mode_time)
# Exponential decay starting at mode
exp_decay <- function(t) {
peak_impact * exp(-0.25 * (t - mode_time))
}
# Create data frame
impact_data <- data.frame(
Time = time,
Impact = ifelse(time < 0, 0, gamma_impact(time)),
Exponential_Fit = ifelse(time >= mode_time, exp_decay(time), NA)
)
# Calculate optimal text positions
text_y_pos <- max(impact_data$Impact, na.rm = TRUE) * c(0.9, 0.7, 0.5)
text_x_pos <- c(mode_time + 3, mode_time + 3, 5)
# Plot
ggplot(impact_data, aes(x = Time)) +
geom_vline(xintercept = 0, linetype = "dashed", color = "blue") +
geom_line(aes(y = Impact), color = "black", linewidth = 1.2) +
geom_line(aes(y = Exponential_Fit), color = "green", linetype = "dashed", linewidth = 1, na.rm = TRUE) +
# Annotations with non-overlapping positions
annotate("text", x = -2.5, y = 0.1*max(impact_data$Impact, na.rm = TRUE),
label = "Baseline", color = "black", hjust = 0.5) +
annotate("text", x = -9, y = 0.6*max(impact_data$Impact, na.rm = TRUE),
label = "MDA Implementation", color = "blue", hjust = 0) +
annotate("text", x = text_x_pos[1], y = text_y_pos[1],
label = "Actual Impact", color = "black", hjust = 0) +
annotate("text", x = text_x_pos[2], y = text_y_pos[2],
label = "Exponential Approximation", color = "green", hjust = 0) +
geom_vline(xintercept = mode_time, linetype = "dotted", color = "gray50") +
annotate("text", x = mode_time, y = 0,
label = "Impact Survey", vjust = -0.5, color = "gray30") +
labs(title = "Impact of Mass Drug Administration (MDA) Over Time",
x = "Time (years)",
y = "Relative Prevalence Reduction",
caption = "Blue dashed line: MDA implementation time\nGreen dashed line: Exponential decay approximation from impact survey") +
theme_minimal() +
theme(plot.caption = element_text(hjust = 0)) +
ylim(0, max(impact_data$Impact, na.rm = TRUE) * 1.1) +
# Ensure no text overlap
coord_cartesian(clip = "off") +
theme(plot.margin = unit(c(1, 1, 1.5, 1), "lines"))
#| echo: false
#| fig-cap: "Impact of MDA over time with Gamma-distributed effect and exponential decay approximation"
#| fig-width: 8
#| fig-height: 5
library(ggplot2)
# Create time sequence (-5 to 20 years)
time <- seq(-10, 20, by = 0.1)
# Define Gamma-shaped MDA impact function
gamma_impact <- function(t) {
# Parameters for Gamma distribution (shape=3, rate=0.7 gives mode around 3)
dgamma(pmax(0, t), shape = 3, rate = 0.7) * 15 # Scaled for visibility
}
# Find the mode (peak time) of the Gamma distribution
mode_time <- (3 - 1)/0.7  # (shape-1)/rate
peak_impact <- gamma_impact(mode_time)
# Exponential decay starting at mode
exp_decay <- function(t) {
peak_impact * exp(-0.25 * (t - mode_time))
}
# Create data frame
impact_data <- data.frame(
Time = time,
Impact = ifelse(time < 0, 0, gamma_impact(time)),
Exponential_Fit = ifelse(time >= mode_time, exp_decay(time), NA)
)
# Calculate optimal text positions
text_y_pos <- max(impact_data$Impact, na.rm = TRUE) * c(0.9, 0.7, 0.5)
text_x_pos <- c(mode_time + 3, mode_time + 3, 5)
# Plot
ggplot(impact_data, aes(x = Time)) +
geom_vline(xintercept = 0, linetype = "dashed", color = "blue") +
geom_line(aes(y = Impact), color = "black", linewidth = 1.2) +
geom_line(aes(y = Exponential_Fit), color = "green", linetype = "dashed", linewidth = 1, na.rm = TRUE) +
# Annotations with non-overlapping positions
annotate("text", x = -2.5, y = 0.1*max(impact_data$Impact, na.rm = TRUE),
label = "Baseline", color = "black", hjust = 0.5) +
annotate("text", x = -9, y = 0.6*max(impact_data$Impact, na.rm = TRUE),
label = "MDA Implementation", color = "blue", hjust = 0) +
annotate("text", x = text_x_pos[1], y = text_y_pos[1],
label = "Actual Impact", color = "black", hjust = 0) +
annotate("text", x = text_x_pos[2], y = text_y_pos[2],
label = "Exponential Approximation", color = "green", hjust = 0) +
geom_vline(xintercept = mode_time, linetype = "dotted", color = "gray50") +
annotate("text", x = mode_time, y = 0,
label = "Impact Survey", vjust = -0.5, color = "gray30") +
labs(title = "Impact of Mass Drug Administration (MDA) Over Time",
x = "Time (years)",
y = "Relative Prevalence Reduction",
caption = "Blue dashed line: MDA implementation time\nGreen dashed line: Exponential decay approximation from impact survey") +
theme_minimal() +
theme(plot.caption = element_text(hjust = 0)) +
ylim(0, max(impact_data$Impact, na.rm = TRUE) * 1.1) +
# Ensure no text overlap
coord_cartesian(clip = "off") +
theme(plot.margin = unit(c(1, 1, 1.5, 1), "lines"))
#| echo: false
#| fig-cap: "Impact of MDA over time with Gamma-distributed effect and exponential decay approximation"
#| fig-width: 8
#| fig-height: 5
library(ggplot2)
# Create time sequence (-5 to 20 years)
time <- seq(-10, 20, by = 0.1)
# Define Gamma-shaped MDA impact function
gamma_impact <- function(t) {
# Parameters for Gamma distribution (shape=3, rate=0.7 gives mode around 3)
dgamma(pmax(0, t), shape = 3, rate = 0.7) * 15 # Scaled for visibility
}
# Find the mode (peak time) of the Gamma distribution
mode_time <- (3 - 1)/0.7  # (shape-1)/rate
peak_impact <- gamma_impact(mode_time)
# Exponential decay starting at mode
exp_decay <- function(t) {
peak_impact * exp(-0.25 * (t - mode_time))
}
# Create data frame
impact_data <- data.frame(
Time = time,
Impact = ifelse(time < 0, 0, gamma_impact(time)),
Exponential_Fit = ifelse(time >= mode_time, exp_decay(time), NA)
)
# Calculate optimal text positions
text_y_pos <- max(impact_data$Impact, na.rm = TRUE) * c(0.9, 0.7, 0.5)
text_x_pos <- c(mode_time + 3, mode_time + 3, 5)
# Plot
ggplot(impact_data, aes(x = Time)) +
geom_vline(xintercept = 0, linetype = "dashed", color = "blue") +
geom_line(aes(y = Impact), color = "black", linewidth = 1.2) +
geom_line(aes(y = Exponential_Fit), color = "green", linetype = "dashed", linewidth = 1, na.rm = TRUE) +
# Annotations with non-overlapping positions
annotate("text", x = -2.5, y = 0.1*max(impact_data$Impact, na.rm = TRUE),
label = "Baseline", color = "black", hjust = 0.5) +
annotate("text", x = -9, y = 0.6*max(impact_data$Impact, na.rm = TRUE),
label = "MDA Implementation", color = "blue", hjust = 0) +
annotate("text", x = text_x_pos[2], y = text_y_pos[2],
label = "MDA Impact Approximation", color = "green", hjust = 0) +
geom_vline(xintercept = mode_time, linetype = "dotted", color = "gray50") +
annotate("text", x = mode_time, y = 0,
label = "Impact Survey", vjust = -0.5, color = "gray30") +
labs(title = "Impact of Mass Drug Administration (MDA) Over Time",
x = "Time (years)",
y = "Relative Prevalence Reduction",
caption = "Blue dashed line: MDA implementation time\nGreen dashed line: Exponential decay approximation from impact survey") +
theme_minimal() +
theme(plot.caption = element_text(hjust = 0)) +
ylim(0, max(impact_data$Impact, na.rm = TRUE) * 1.1) +
# Ensure no text overlap
coord_cartesian(clip = "off") +
theme(plot.margin = unit(c(1, 1, 1.5, 1), "lines"))
#| echo: false
#| fig-cap: "Impact of MDA over time with Gamma-distributed effect and exponential decay approximation"
#| fig-width: 8
#| fig-height: 5
library(ggplot2)
# Create time sequence (-5 to 20 years)
time <- seq(-10, 20, by = 0.1)
# Define Gamma-shaped MDA impact function
gamma_impact <- function(t) {
# Parameters for Gamma distribution (shape=3, rate=0.7 gives mode around 3)
dgamma(pmax(0, t), shape = 3, rate = 0.7) * 15 # Scaled for visibility
}
# Find the mode (peak time) of the Gamma distribution
mode_time <- (3 - 1)/0.7  # (shape-1)/rate
peak_impact <- gamma_impact(mode_time)
# Exponential decay starting at mode
exp_decay <- function(t) {
peak_impact * exp(-0.25 * (t - mode_time))
}
# Create data frame
impact_data <- data.frame(
Time = time,
Impact = ifelse(time < 0, 0, gamma_impact(time)),
Exponential_Fit = ifelse(time >= mode_time, exp_decay(time), NA)
)
# Calculate optimal text positions
text_y_pos <- max(impact_data$Impact, na.rm = TRUE) * c(0.9, 0.7, 0.5)
text_x_pos <- c(mode_time + 3, mode_time + 3, 5)
# Plot
ggplot(impact_data, aes(x = Time)) +
geom_vline(xintercept = 0, linetype = "dashed", color = "blue") +
geom_line(aes(y = Impact), color = "black", linewidth = 1.2) +
geom_line(aes(y = Exponential_Fit), color = "green", linetype = "dashed", linewidth = 1, na.rm = TRUE) +
# Annotations with non-overlapping positions
annotate("text", x = -2.5, y = 0.1*max(impact_data$Impact, na.rm = TRUE),
label = "Baseline", color = "black", hjust = 0.5) +
annotate("text", x = -9, y = 0.6*max(impact_data$Impact, na.rm = TRUE),
label = "MDA Implementation", color = "blue", hjust = 0) +
annotate("text", x = text_x_pos[2], y = text_y_pos[2],
label = "MDA Impact Approximation", color = "green", hjust = 0) +
geom_vline(xintercept = mode_time, linetype = "dotted", color = "gray50") +
annotate("text", x = mode_time+2, y = 0,
label = "Impact Survey", vjust = -0.5, color = "gray30") +
labs(title = "Impact of Mass Drug Administration (MDA) Over Time",
x = "Time (years)",
y = "Relative Prevalence Reduction",
caption = "Blue dashed line: MDA implementation time\nGreen dashed line: Exponential decay approximation from impact survey") +
theme_minimal() +
theme(plot.caption = element_text(hjust = 0)) +
ylim(0, max(impact_data$Impact, na.rm = TRUE) * 1.1) +
# Ensure no text overlap
coord_cartesian(clip = "off") +
theme(plot.margin = unit(c(1, 1, 1.5, 1), "lines"))
#| echo: false
#| fig-cap: "Impact of MDA over time with Gamma-distributed effect and exponential decay approximation"
#| fig-width: 8
#| fig-height: 5
library(ggplot2)
# Create time sequence (-5 to 20 years)
time <- seq(-10, 20, by = 0.1)
# Define Gamma-shaped MDA impact function
gamma_impact <- function(t) {
# Parameters for Gamma distribution (shape=3, rate=0.7 gives mode around 3)
dgamma(pmax(0, t), shape = 3, rate = 0.7) * 15 # Scaled for visibility
}
# Find the mode (peak time) of the Gamma distribution
mode_time <- (3 - 1)/0.7  # (shape-1)/rate
peak_impact <- gamma_impact(mode_time)
# Exponential decay starting at mode
exp_decay <- function(t) {
peak_impact * exp(-0.25 * (t - mode_time))
}
# Create data frame
impact_data <- data.frame(
Time = time,
Impact = ifelse(time < 0, 0, gamma_impact(time)),
Exponential_Fit = ifelse(time >= mode_time, exp_decay(time), NA)
)
# Calculate optimal text positions
text_y_pos <- max(impact_data$Impact, na.rm = TRUE) * c(0.9, 0.7, 0.5)
text_x_pos <- c(mode_time + 3, mode_time + 3, 5)
# Plot
ggplot(impact_data, aes(x = Time)) +
geom_vline(xintercept = 0, linetype = "dashed", color = "blue") +
geom_line(aes(y = Impact), color = "black", linewidth = 1.2) +
geom_line(aes(y = Exponential_Fit), color = "green", linetype = "dashed", linewidth = 1, na.rm = TRUE) +
# Annotations with non-overlapping positions
annotate("text", x = -2.5, y = 0.1*max(impact_data$Impact, na.rm = TRUE),
label = "Baseline", color = "black", hjust = 0.5) +
annotate("text", x = -9, y = 0.6*max(impact_data$Impact, na.rm = TRUE),
label = "MDA Implementation", color = "blue", hjust = 0) +
annotate("text", x = text_x_pos[2], y = text_y_pos[2],
label = "MDA Impact Approximation", color = "green", hjust = 0) +
geom_vline(xintercept = mode_time, linetype = "dotted", color = "gray50") +
annotate("text", x = mode_time+3, y = 0,
label = "Impact Survey", vjust = -0.5, color = "gray30") +
labs(title = "Impact of Mass Drug Administration (MDA) Over Time",
x = "Time (years)",
y = "Relative Prevalence Reduction",
caption = "Blue dashed line: MDA implementation time\nGreen dashed line: Exponential decay approximation from impact survey") +
theme_minimal() +
theme(plot.caption = element_text(hjust = 0)) +
ylim(0, max(impact_data$Impact, na.rm = TRUE) * 1.1) +
# Ensure no text overlap
coord_cartesian(clip = "off") +
theme(plot.margin = unit(c(1, 1, 1.5, 1), "lines"))
#| echo: false
#| fig-cap: "Impact of MDA over time with Gamma-distributed effect and exponential decay approximation"
#| fig-width: 8
#| fig-height: 5
library(ggplot2)
# Create time sequence (-5 to 20 years)
time <- seq(-10, 20, by = 0.1)
# Define Gamma-shaped MDA impact function
gamma_impact <- function(t) {
# Parameters for Gamma distribution (shape=3, rate=0.7 gives mode around 3)
dgamma(pmax(0, t), shape = 3, rate = 0.7) * 15 # Scaled for visibility
}
# Find the mode (peak time) of the Gamma distribution
mode_time <- (3 - 1)/0.7  # (shape-1)/rate
peak_impact <- gamma_impact(mode_time)
# Exponential decay starting at mode
exp_decay <- function(t) {
peak_impact * exp(-0.25 * (t - mode_time))
}
# Create data frame
impact_data <- data.frame(
Time = time,
Impact = ifelse(time < 0, 0, gamma_impact(time)),
Exponential_Fit = ifelse(time >= mode_time, exp_decay(time), NA)
)
# Calculate optimal text positions
text_y_pos <- max(impact_data$Impact, na.rm = TRUE) * c(0.9, 0.7, 0.5)
text_x_pos <- c(mode_time + 3, mode_time + 3, 5)
# Plot
ggplot(impact_data, aes(x = Time)) +
geom_vline(xintercept = 0, linetype = "dashed", color = "blue") +
geom_line(aes(y = Impact), color = "black", linewidth = 1.2) +
geom_line(aes(y = Exponential_Fit), color = "green", linetype = "dashed", linewidth = 1, na.rm = TRUE) +
# Annotations with non-overlapping positions
annotate("text", x = -2.5, y = 0.1*max(impact_data$Impact, na.rm = TRUE),
label = "Baseline", color = "black", hjust = 0.5) +
annotate("text", x = -9, y = 0.6*max(impact_data$Impact, na.rm = TRUE),
label = "MDA Implementation", color = "blue", hjust = 0) +
annotate("text", x = text_x_pos[2], y = text_y_pos[2],
label = "MDA Impact Approximation", color = "green", hjust = 0) +
geom_vline(xintercept = mode_time, linetype = "dotted", color = "gray50") +
annotate("text", x = mode_time+3, y = 0,
label = "Impact Survey", vjust = -1.5, color = "gray30") +
labs(title = "Impact of Mass Drug Administration (MDA) Over Time",
x = "Time (years)",
y = "Relative Prevalence Reduction",
caption = "Blue dashed line: MDA implementation time\nGreen dashed line: Exponential decay approximation from impact survey") +
theme_minimal() +
theme(plot.caption = element_text(hjust = 0)) +
ylim(0, max(impact_data$Impact, na.rm = TRUE) * 1.1) +
# Ensure no text overlap
coord_cartesian(clip = "off") +
theme(plot.margin = unit(c(1, 1, 1.5, 1), "lines"))
#| echo: false
#| fig-cap: "Impact of MDA over time with Gamma-distributed effect and exponential decay approximation"
#| fig-width: 8
#| fig-height: 5
library(ggplot2)
# Create time sequence (-5 to 20 years)
time <- seq(-10, 20, by = 0.1)
# Define Gamma-shaped MDA impact function
gamma_impact <- function(t) {
# Parameters for Gamma distribution (shape=3, rate=0.7 gives mode around 3)
dgamma(pmax(0, t), shape = 3, rate = 0.7) * 15 # Scaled for visibility
}
# Find the mode (peak time) of the Gamma distribution
mode_time <- (3 - 1)/0.7  # (shape-1)/rate
peak_impact <- gamma_impact(mode_time)
# Exponential decay starting at mode
exp_decay <- function(t) {
peak_impact * exp(-0.25 * (t - mode_time))
}
# Create data frame
impact_data <- data.frame(
Time = time,
Impact = ifelse(time < 0, 0, gamma_impact(time)),
Exponential_Fit = ifelse(time >= mode_time, exp_decay(time), NA)
)
# Calculate optimal text positions
text_y_pos <- max(impact_data$Impact, na.rm = TRUE) * c(0.9, 0.7, 0.5)
text_x_pos <- c(mode_time + 3, mode_time + 3, 5)
# Plot
ggplot(impact_data, aes(x = Time)) +
geom_vline(xintercept = 0, linetype = "dashed", color = "blue") +
geom_line(aes(y = Impact), color = "black", linewidth = 1.2) +
geom_line(aes(y = Exponential_Fit), color = "green", linetype = "dashed", linewidth = 1, na.rm = TRUE) +
# Annotations with non-overlapping positions
annotate("text", x = -2.5, y = 0.1*max(impact_data$Impact, na.rm = TRUE),
label = "Baseline", color = "black", hjust = 0.5) +
annotate("text", x = -9, y = 0.6*max(impact_data$Impact, na.rm = TRUE),
label = "MDA Implementation", color = "blue", hjust = 0) +
annotate("text", x = text_x_pos[2], y = text_y_pos[2],
label = "MDA Impact Approximation", color = "green", hjust = 0) +
geom_vline(xintercept = mode_time, linetype = "dotted", color = "gray50") +
annotate("text", x = mode_time+3, y = 0,
label = "Impact Survey", vjust = 1.5, color = "gray30") +
labs(title = "Impact of Mass Drug Administration (MDA) Over Time",
x = "Time (years)",
y = "Relative Prevalence Reduction",
caption = "Blue dashed line: MDA implementation time\nGreen dashed line: Exponential decay approximation from impact survey") +
theme_minimal() +
theme(plot.caption = element_text(hjust = 0)) +
ylim(0, max(impact_data$Impact, na.rm = TRUE) * 1.1) +
# Ensure no text overlap
coord_cartesian(clip = "off") +
theme(plot.margin = unit(c(1, 1, 1.5, 1), "lines"))
#| echo: false
#| fig-cap: "Impact of MDA over time with Gamma-distributed effect and exponential decay approximation"
#| fig-width: 8
#| fig-height: 5
library(ggplot2)
# Create time sequence (-5 to 20 years)
time <- seq(-10, 20, by = 0.1)
# Define Gamma-shaped MDA impact function
gamma_impact <- function(t) {
# Parameters for Gamma distribution (shape=3, rate=0.7 gives mode around 3)
dgamma(pmax(0, t), shape = 3, rate = 0.7) * 15 # Scaled for visibility
}
# Find the mode (peak time) of the Gamma distribution
mode_time <- (3 - 1)/0.7  # (shape-1)/rate
peak_impact <- gamma_impact(mode_time)
# Exponential decay starting at mode
exp_decay <- function(t) {
peak_impact * exp(-0.25 * (t - mode_time))
}
# Create data frame
impact_data <- data.frame(
Time = time,
Impact = ifelse(time < 0, 0, gamma_impact(time)),
Exponential_Fit = ifelse(time >= mode_time, exp_decay(time), NA)
)
# Calculate optimal text positions
text_y_pos <- max(impact_data$Impact, na.rm = TRUE) * c(0.9, 0.7, 0.5)
text_x_pos <- c(mode_time + 3, mode_time + 3, 5)
# Plot
ggplot(impact_data, aes(x = Time)) +
geom_vline(xintercept = 0, linetype = "dashed", color = "blue") +
geom_line(aes(y = Impact), color = "black", linewidth = 1.2) +
geom_line(aes(y = Exponential_Fit), color = "green", linetype = "dashed", linewidth = 1, na.rm = TRUE) +
# Annotations with non-overlapping positions
annotate("text", x = -2.5, y = 0.1*max(impact_data$Impact, na.rm = TRUE),
label = "Baseline", color = "black", hjust = 0.5) +
annotate("text", x = -9, y = 0.6*max(impact_data$Impact, na.rm = TRUE),
label = "MDA Implementation", color = "blue", hjust = 0) +
annotate("text", x = text_x_pos[2], y = text_y_pos[2],
label = "MDA Impact Approximation", color = "green", hjust = 0) +
geom_vline(xintercept = mode_time, linetype = "dotted", color = "gray50") +
annotate("text", x = mode_time+3, y = 0,
label = "Impact Survey", vjust = 1.5, color = "gray30") +
labs(title = "Impact of Mass Drug Administration (MDA) Over Time",
x = "Time (years)",
y = "Relative Prevalence Reduction",
caption = "Blue dashed line: MDA implementation time\nGreen dashed line: Decay approximation from geostatistical model") +
theme_minimal() +
theme(plot.caption = element_text(hjust = 0)) +
ylim(0, max(impact_data$Impact, na.rm = TRUE) * 1.1) +
# Ensure no text overlap
coord_cartesian(clip = "off") +
theme(plot.margin = unit(c(1, 1, 1.5, 1), "lines"))
htmltools
install.packages("htmltools")
install.packages("kable")
install.packages("knitr")
#| echo: false
#| results: asis
library(knitr)
install.packages("kableExtra")
